<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title xmlns:ng="http://docbook.org/docbook-ng">rules</title><link rel="stylesheet" type="text/css" href="schematron4.css"><meta xmlns:ng="http://docbook.org/docbook-ng" name="generator" content="DocBook XSL Stylesheets V1.79.2"><link rel="home" href="index.html" title="What's New In Schematron 4"><link rel="up" href="pt02.html" title="New elements"><link rel="prev" href="ch08.html" title="library"><link rel="next" href="pt03.html" title="New functionality"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center"><code class="sgmltag-element">rules</code></th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch08.html">Prev</a>&nbsp;</td><th width="60%" align="center">New elements</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="pt03.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="d5e429"></a><code class="sgmltag-element">rules</code></h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="ch09.html#d5e444">Declaration</a></span></dt><dt><span class="section"><a href="ch09.html#d5e452">Related GitHub issue(s)</a></span></dt><dt><span class="section"><a href="ch09.html#d5e456">Sample usage</a></span></dt><dt><span class="section"><a href="ch09.html#d5e469">Commentary</a></span></dt></dl></div><div class="itemizedlist"><p class="title"><b>Element context(s)</b></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="sgmltag-element">library</code></p></li><li class="listitem"><p><code class="sgmltag-element">schema</code></p></li></ul></div><div class="blockquote"><a name="rules-elem"></a><blockquote class="blockquote"><div class="blockquote-title"><p><b>Clause 5.4.16 (<code class="literal">rules</code> element)</b></p></div><p>The rules element is a container for abstract rules, allowing their use across patterns. This element may be used as a top-level element in a schema and can also be used in a library.</p></blockquote></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d5e444"></a>Declaration</h2></div></div></div><pre class="programlisting">element schema {
        attribute id { xsd:ID }?,
        rich,
        attribute schemaVersion { non-empty-string }?,
        attribute schematronEdition { non-empty-string }?,
        attribute defaultPhase { xsd:IDREF }?,
        attribute queryBinding { non-empty-string }?,
        (foreign
         &amp; (inclusion | extends)*
         &amp; (title?, ns*, p*, param*, let*, phase*, <span class="highlight">abstract-rules</span>*, (rule-set|pattern)+, p*, diagnostics?, properties?))
    }</pre><pre class="programlisting">element library {
        attribute id { xsd:ID }?,
        rich,
        (foreign
         &amp; (inclusion | extends)*
         &amp; (title?, p*, param*, let*, <span class="highlight">abstract-rules</span>*, (rule-set|pattern)*, p*, diagnostics?, properties?))
    }</pre><pre class="programlisting">abstract-rules =
    element <span class="highlight">rules</span> {
        attribute id { xsd:ID }?,
        rich,
        title?,
        p*,
        abstract-rule+
    }</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d5e452"></a>Related GitHub issue(s)</h2></div></div></div><p><a class="link" href="https://github.com/Schematron/schematron-enhancement-proposals/issues/3" target="_top">A container element for abstract Schematron rules</a></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d5e456"></a>Sample usage</h2></div></div></div><div class="example"><a name="rules-elem-example"></a><p class="title"><b>Example&nbsp;14.&nbsp;<code class="literal">rules</code> element</b></p><div class="example-contents"><p>Given this schema:</p><pre class="programlisting"><strong class="hl-tag" style="color: #000096">&lt;sch:schema</strong> <span class="hl-attribute" style="color: #F5844C">xmlns:sch</span>=<span class="hl-value" style="color: #993300">"http://purl.oclc.org/dsdl/schematron"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
  <span class="highlight">&lt;sch:rules&gt;
    &lt;sch:rule abstract="true" id="abstract-rule"&gt;
      &lt;sch:report test="self::element"/&gt;
    &lt;/sch:rule&gt;
    &lt;sch:rule abstract="true" id="abstract-rule-2"&gt;
      &lt;sch:report test="name()"/&gt;
    &lt;/sch:rule&gt;
  &lt;/sch:rules&gt;</span>
  <strong class="hl-tag" style="color: #000096">&lt;sch:pattern&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;sch:rule</strong> <span class="hl-attribute" style="color: #F5844C">context</span>=<span class="hl-value" style="color: #993300">"element"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
      <strong class="hl-tag" style="color: #000096">&lt;sch:extends</strong> <span class="hl-attribute" style="color: #F5844C">rule</span>=<span class="hl-value" style="color: #993300">"abstract-rule"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;/sch:rule&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;sch:rule</strong> <span class="hl-attribute" style="color: #F5844C">context</span>=<span class="hl-value" style="color: #993300">"*"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
      <strong class="hl-tag" style="color: #000096">&lt;sch:extends</strong> <span class="hl-attribute" style="color: #F5844C">rule</span>=<span class="hl-value" style="color: #993300">"abstract-rule-2"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;/sch:rule&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;/sch:pattern&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/sch:schema&gt;</strong></pre><p>the two abstract <code class="sgmltag-element">rule</code> elements contained in <code class="sgmltag-element">rules</code> will be instantiated as usual, resulting in this expanded schema:</p><pre class="programlisting"><strong class="hl-tag" style="color: #000096">&lt;sch:schema</strong> <span class="hl-attribute" style="color: #F5844C">xmlns:sch</span>=<span class="hl-value" style="color: #993300">"http://purl.oclc.org/dsdl/schematron"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;sch:pattern&gt;</strong>
    <span class="highlight">&lt;sch:rule context="element"&gt;
      &lt;sch:report test="self::element"/&gt;
    &lt;/sch:rule&gt;
    &lt;sch:rule context="*"&gt;
      &lt;sch:report test="name()"/&gt;
    &lt;/sch:rule&gt;</span>
  <strong class="hl-tag" style="color: #000096">&lt;/sch:pattern&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/sch:schema&gt;</strong></pre></div></div><br class="example-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d5e469"></a>Commentary</h2></div></div></div><p>The behaviour of abstract rules and how they are processed remains unchanged here. What is new is the container for abstract rules, which would previously have to have been stored separately and instantiated using <code class="sgmltag-element">extends/@href</code>.</p><p>More background on this can be found in <a class="link" href="https://dmaus.name/blog/2021.02/" target="_top">this blog post</a> by David Maus.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch08.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="pt02.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="pt03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"><code class="sgmltag-element">library</code>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;New functionality</td></tr></table></div></body></html>